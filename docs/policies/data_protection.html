<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.551">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="CloudCore takes the confidentiality and integrity of its customer data very seriously.">

<title>CloudCore - Data Protection</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">CloudCore</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../pricing.html"> 
<span class="menu-text">Pricing</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blog/index.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../chatbots/index.html"> 
<span class="menu-text">Staff-Clients</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-docs" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Docs</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-docs">    
        <li>
    <a class="dropdown-item" href="../../docs/interviews.html">
 <span class="dropdown-text">Transcripts</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../docs/policies.html">
 <span class="dropdown-text">Policies</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../docs/support.html">
 <span class="dropdown-text">Other</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../contact.html"> 
<span class="menu-text">Contact US</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#policy-statements" id="toc-policy-statements" class="nav-link active" data-scroll-target="#policy-statements">Policy Statements</a></li>
  <li><a href="#controls-and-procedures" id="toc-controls-and-procedures" class="nav-link" data-scroll-target="#controls-and-procedures">Controls and Procedures</a>
  <ul class="collapse">
  <li><a href="#data-protection-implementation-and-processes" id="toc-data-protection-implementation-and-processes" class="nav-link" data-scroll-target="#data-protection-implementation-and-processes">Data Protection Implementation and Processes</a></li>
  <li><a href="#protecting-data-at-rest" id="toc-protecting-data-at-rest" class="nav-link" data-scroll-target="#protecting-data-at-rest">Protecting Data At Rest</a></li>
  <li><a href="#protecting-data-in-transit" id="toc-protecting-data-in-transit" class="nav-link" data-scroll-target="#protecting-data-in-transit">Protecting Data In Transit</a></li>
  <li><a href="#protecting-data-in-use" id="toc-protecting-data-in-use" class="nav-link" data-scroll-target="#protecting-data-in-use">Protecting Data In Use</a></li>
  <li><a href="#encryption-key-management" id="toc-encryption-key-management" class="nav-link" data-scroll-target="#encryption-key-management">Encryption Key Management</a></li>
  <li><a href="#certificate-management" id="toc-certificate-management" class="nav-link" data-scroll-target="#certificate-management">Certificate Management</a></li>
  <li><a href="#data-integrity-protection" id="toc-data-integrity-protection" class="nav-link" data-scroll-target="#data-integrity-protection">Data Integrity Protection</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Data Protection</h1>
  <div class="quarto-categories">
    <div class="quarto-category">Data Security</div>
    <div class="quarto-category">Compliance</div>
    <div class="quarto-category">Encryption Standards</div>
  </div>
  </div>

<div>
  <div class="description">
    CloudCore takes the confidentiality and integrity of its customer data very seriously.
  </div>
</div>


<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<table class="table">
<tbody>
<tr class="odd">
<td><strong>Title</strong></td>
<td>Data Protection</td>
</tr>
<tr class="even">
<td><strong>Doc#</strong></td>
<td>POL-DATA-004</td>
</tr>
<tr class="odd">
<td><strong>Version</strong></td>
<td>1.0</td>
</tr>
<tr class="even">
<td><strong>Date</strong></td>
<td>25-08-2023</td>
</tr>
</tbody>
</table>
<p>CloudCore takes the confidentiality and integrity of its customer data very seriously. As stewards and partners of CloudCore Customers, we strive to assure data is protected from unauthorised access and that it is available when needed. The following policies drive many of our procedures and technical controls in support of the CloudCore mission of data protection.</p>
<p>Production systems that create, receive, store, or transmit Customer data (hereafter “Production Systems”) must follow the requirements and guidelines described in this section.</p>
<section id="policy-statements" class="level2">
<h2 class="anchored" data-anchor-id="policy-statements">Policy Statements</h2>
<p>CloudCore policy requires that:</p>
<ol type="a">
<li><p>Data must be handled and protected according to its classification requirements and following approved encryption standards, if applicable.</p></li>
<li><p>Whenever possible, store data of the same classification in a given data repository and avoid mixing sensitive and non-sensitive data in the same repository. Security controls, including authentication, authorisation, data encryption, and auditing, should be applied according to the highest classification of data in a given repository.</p></li>
<li><p>Workforce members shall not have direct administrative access to production data during normal business operations. Exceptions include emergency operations such as forensic analysis and manual disaster recovery.</p></li>
<li><p>All Production Systems must disable services that are not required to achieve the business purpose or function of the system.</p></li>
<li><p>All access to Production Systems must be logged, following the CloudCore Auditing Policy.</p></li>
<li><p>All Production Systems must have security monitoring enabled, including activity and file integrity monitoring, vulnerability scanning, and/or malware detection, as applicable.</p></li>
</ol>
</section>
<section id="controls-and-procedures" class="level2">
<h2 class="anchored" data-anchor-id="controls-and-procedures">Controls and Procedures</h2>
<section id="data-protection-implementation-and-processes" class="level3">
<h3 class="anchored" data-anchor-id="data-protection-implementation-and-processes">Data Protection Implementation and Processes</h3>
<p>Data is classified and handled according to the CloudCore Data Handling Specifications and Data Classification document.</p>
<p>Critical, confidential and internal data will be tagged upon creation, if tagging is supported. Each tag maps to a data type defined in the data classification scheme, which then maps to a protection level for encryption, access control, backup, and retention. Data classification may alternatively be identified by its location/repository. For example, source codes in CloudCore’s repos are considered “Internal” by default, even though a tag is not directly applied to each source file.</p>
<p>Critical and confidential data is always stored and transmitted securely, using approved encryption standards. More details are specified in CloudCore’s Data Classification and Handling document.</p>
<p>All IT systems that process and store sensitive data follow the provisioning process, configuration, change management, patching and anti-malware standards as defined in <a href="../../docs/policies/ccm.html">Configuration and Change Management document</a>.</p>
<section id="customerproduction-data-protection" class="level4">
<h4 class="anchored" data-anchor-id="customerproduction-data-protection">Customer/Production Data Protection</h4>
<p>CloudCore hosts on Amason Web Services in the US-East (Ohio) region by default. Data is replicated across multiple regions for redundancy and disaster recovery.</p>
<p>All CloudCore employees, systems, and resources adhere to the following standards and processes to reduce the risk of compromise of Production Data:</p>
<ol type="1">
<li>Implement and/or review controls designed to protect Production Data from improper alteration or destruction.</li>
<li>Ensure that confidential data is stored in a manner that supports user access logs and automated monitoring for potential security incidents.</li>
<li>Ensure CloudCore Customer Production Data is segmented and only accessible to Customer authorised to access data.</li>
<li>All Production Data at rest is stored on encrypted volumes using encryption keys managed by CloudCore. Encryption at rest is ensured through the use of automated deployment scripts referenced in <a href="../../docs/policies/ccm.html">Configuration and Change Management</a>.</li>
<li>Volume encryption keys and machines that generate volume encryption keys are protected from unauthorised access. Volume encryption key material is protected with access controls such that the key material is only accessible by privileged accounts.</li>
<li>Encrypted volumes use approved cipher algorithms, key strength, and key management process as defined in §12.3.1 above.</li>
<li>Raid volume drives are individually encrypted and assembled on boot requiring a manual input of the key to mount the encrypted volume.</li>
</ol>
</section>
<section id="access" class="level4">
<h4 class="anchored" data-anchor-id="access">Access</h4>
<p>CloudCore employee access to production is guarded by an approval process and by default is disabled. When access is approved, temporary access is granted that allows access to production. Production access is reviewed by the security team on a case by case basis.</p>
</section>
<section id="separation" class="level4">
<h4 class="anchored" data-anchor-id="separation">Separation</h4>
<p>Customer data is logically separated at the database/datastore level using a unique identifier for the institution. The separation is enforced at the API layer where the client must authenticate with a chosen institution and then the customer unique identifier is included in the access token and used by the API to restrict access to data to the institution. All database/datastore queries then include the institution identifier.</p>
</section>
<section id="backup-and-recovery" class="level4">
<h4 class="anchored" data-anchor-id="backup-and-recovery">Backup and Recovery</h4>
<p>For details on the backup and recovery process, see controls and procedures defined in <a href="data-mgmt.md">Data Management</a>.</p>
</section>
<section id="monitoring" class="level4">
<h4 class="anchored" data-anchor-id="monitoring">Monitoring</h4>
<p>CloudCore uses AWS CloudWatch/CloudTrail to monitor the entire cloud service operation. If a system failure and alarm is triggered, key personnel are notified by text, chat, and/or email message in order to take appropriate corrective action. Escalation may be required and there is an on-call rotation for major services when further support is necessary.</p>
<p>CloudCore uses a security agent to monitor production systems. The agents monitor system activities, generate alerts on suspicious activities and report on vulnerability findings to a centralised management console.</p>
<p>The security agent is installed on all on premise Linux servers. It is also built into Amason Machine Images (AMIs) for use in CloudCore AWS environments.</p>
</section>
</section>
<section id="protecting-data-at-rest" class="level3">
<h3 class="anchored" data-anchor-id="protecting-data-at-rest">Protecting Data At Rest</h3>
<section id="encryption-of-data-at-rest" class="level4">
<h4 class="anchored" data-anchor-id="encryption-of-data-at-rest">Encryption of Data at Rest</h4>
<p>All databases, data stores, and file systems are encrypted with AES-256 using separate keys for each storage type. The keys are rotated periodically.</p>
</section>
<section id="local-diskvolume-encryption" class="level4">
<h4 class="anchored" data-anchor-id="local-diskvolume-encryption">Local Disk/Volume Encryption</h4>
<p>Encryption and key management for local disk encryption of on-premise servers and end-user devices follow the defined best practices for Windows, macOS, and Linux/Unix operating systems, such as Bitlocker and FileVault.</p>
</section>
</section>
<section id="protecting-data-in-transit" class="level3">
<h3 class="anchored" data-anchor-id="protecting-data-in-transit">Protecting Data In Transit</h3>
<ol type="1">
<li><p>All external data transmission is encrypted end-to-end using encryption keys managed by CloudCore. This includes, but is not limited to, cloud infrastructure and third party vendors and applications.</p></li>
<li><p>Transmission encryption keys and systems that generate keys are protected from unauthorised access. Transmission encryption key materials are protected with access controls, and may only be accessed by privileged accounts.</p></li>
<li><p>Transmission encryption keys use a minimum of 4096-bit RSA keys, or keys and ciphers of equivalent or higher cryptographic strength (e.g., 256-bit AES session keys in the case of IPSec encryption).</p></li>
<li><p>Transmission encryption keys are limited to use for one year and then must be regenerated.</p></li>
<li><p>For all CloudCore APIs, enforcement of authentication, authorisation, and auditing is used for all remote systems sending, receiving, or storing data.</p></li>
<li><p>System logs of all transmissions of Production Data access are kept. These logs must be available for audit.</p></li>
</ol>
<section id="encryption-of-data-in-transit" class="level4">
<h4 class="anchored" data-anchor-id="encryption-of-data-in-transit">Encryption of Data in Transit</h4>
<p>All internet and intranet connections are encrypted and authenticated using TLS 1.2 (a strong protocol), ECDHE_RSA with P-256 (a strong key exchange), and AES_128_GCM (a strong cipher).</p>
</section>
<section id="data-protection-via-end-user-messaging-channels" class="level4">
<h4 class="anchored" data-anchor-id="data-protection-via-end-user-messaging-channels">Data protection via end-user messaging channels</h4>
<p>Restricted and sensitive data is not allowed to be sent over electronic end-user messaging channels such as email or chat, unless end-to-end encryption is enabled.</p>
</section>
</section>
<section id="protecting-data-in-use" class="level3">
<h3 class="anchored" data-anchor-id="protecting-data-in-use">Protecting Data In Use</h3>
<p>Data in Use, sometimes known as Data in Process, refers to active data being processed by systems and applications which is typically stored in a non-persistent digital state such as in computer random-access memory (RAM), CPU caches, or CPU registers.</p>
<p>Protection of data in use relies on application layer controls and system access controls. See the <a href="../../docs/policies/sdlc.html">Production Security / SDLC</a> and <a href="../../docs/policies/access.html">Access</a> sections for details.</p>
<p>CloudCore applications implement logical account-level data segregation to protect data in a multi-tenancy deployment. In addition, CloudCore applications may incorporate advanced security features such as Runtime Application Self Protection (RASP) modules and Attribute Based Access Control (ABAC) for protection of data in use.</p>
</section>
<section id="encryption-key-management" class="level3">
<h3 class="anchored" data-anchor-id="encryption-key-management">Encryption Key Management</h3>
<p>CloudCore uses AWS Key Management Service (KMS) for encryption key management.</p>
<ul>
<li><p>KMS keys are unique to CloudCore environments and services.</p></li>
<li><p>KMS keys are automatically rotated yearly.</p></li>
</ul>
</section>
<section id="certificate-management" class="level3">
<h3 class="anchored" data-anchor-id="certificate-management">Certificate Management</h3>
<p>CloudCore uses AWS Certificate Manager (ACM) and LetsEncrypt for certificate management.</p>
<ul>
<li><p>Certificates are renewed automatically.</p></li>
<li><p>Security team monitors the certificates for expiration, potential compromise and use/validity. Certificate revocation process is invoked if the certificate is no longer needed or upon discovery of potential compromise.</p></li>
</ul>
</section>
<section id="data-integrity-protection" class="level3">
<h3 class="anchored" data-anchor-id="data-integrity-protection">Data Integrity Protection</h3>
<p>When appropriate, CloudCore engineering should implement “Versioning” and “Lifecycle”, or equivalent data management mechanism, such that direct edit and delete actions are not allowed on the data to prevent accidental or malicious overwrite. This protects against human errors and cyberattacks such as ransomware.</p>
<p>In AWS, the IAM and S3 bucket policy in production will be implemented accordingly when the environments are configured. When changes must be made, a new version is created instead of editing and overwriting existing data.</p>
<ul>
<li><p>All edits create a new version and old versions are preserved for a period of time defined in the lifecycle policy.</p></li>
<li><p>Data objects are “marked for deletion” when deleted so that they are recoverable if needed within a period of time defined according to the data retention policy.</p></li>
<li><p>Data is archived offsite – i.e.&nbsp;to separate AWS account and/or region.</p></li>
</ul>
<p>Additionally, all access to sensitive data is authenticated, and audited via logging of the infrastructure, systems and/or application.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/teaching-repositories\.github\.io\/cloudcore\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>4 Millrose Dr, Malaga, WA 6090 and 11 Newcastle St, Perth, WA 6000<br>
cloudcore@serveur.au, +61 (8) 4587 899<br>
Copyright 2021, CloudCore<br>
<a href="https://lordicon.com/">Icons by Lordicon.com</a></p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>